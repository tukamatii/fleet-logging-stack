# fleet.yaml
defaultNamespace: loki

namespaceLabels:
  okbtsp.corp/department: OIT
  okbtsp.corp/owner: baranav
  okbtsp.corp/project: loki

name: loki

# Кастомизация под кластеры
targetCustomizations:
  # === AGGREGATOR ===
  - name: aggregator
    clusterSelector:
      matchLabels:
        okbtsp.corp/monitoring-aggregator: "true"
    helm:
      takeOwnership: true
      chart: loki-simple-scalable
      repo: https://grafana.github.io/helm-charts
      version: 1.8.11
      valuesFiles:
        - loki-values.yaml
    kustomize:
      dir: "additional"

  - name: namespace-only-placeholder
    clusterSelector:
      matchLabels:
        okbtsp.corp/department: OIT
    kustomize:
      dir: "base"

dependsOn:
  - selector:
      matchLabels:
        okbtsp.corp/project: external-secrets
  - name: prom-operator
